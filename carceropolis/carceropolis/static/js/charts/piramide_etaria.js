/* Example from: http://vispublica.gov.br/vispublica/publico/catalogo/highcharts/piramideEtaria.jsp */

var categories = ['menor que 1', '1-4', '5-9', '10-14', '15-19', '20-29', '30-39', '40-49', '50-59', '60-69', '70-79', 'maior que 80'];

var serie = {
      region: 'em todas as regiões',
      title: 'População Residente no Brasil',
      year: '2009',
      valueMax: 18000000,
      valueMin: -18000000,
      nameM: 'Masculino',
      nameF: 'Feminino',
      dataM: [-1539025, -6464883, -8637102, -8381307, -8511943, -17597650, -14259769, -11665684, -8334691, -4911937, -2616817, -1129793],
      dataF: [1474664, 6209355, 8323561, 8108224, 8272143, 17570313, 14852679, 12614307, 9235659, 5713465, 3392732, 1663342]
    }

function generateChart(serie){

    var ano = serie.year;
    var regiao = serie.region;

    if(regiao=='em todas as regiões'){
        serie.valueMax = 18000000;
        serie.valueMin = -18000000;
        switch(ano){
            case '2009':
                serie.dataM=[-1539025, -6464883, -8637102, -8381307, -8511943, -17597650, -14259769, -11665684, -8334691, -4911937, -2616817, -1129793],
                serie.dataF=[1474664, 6209355, 8323561, 8108224, 8272143, 17570313, 14852679, 12614307, 9235659, 5713465, 3392732, 1663342]
                break;
            case '2010':
                serie.dataM=[-1378532, -5638455, -7624144, -8725413, -8558868, -17091222, -14484322, -12012583, -8737339, -5265099, -2757891, -1133122],
                serie.dataF=[1334712, 5444460, 7345231, 8441348, 8432002, 17258381, 15148771, 12830135, 9679282, 6084830, 3547194, 1802463]
                break;
            case '2011':
                serie.dataM=[-1391014, -5689160, -7691375, -8800925, -8632275, -17243446, -14611631, -12113122, -8807405, -5305119, -2777732, -1140928],
                serie.dataF=[1346861, 5493758, 7410533, 8515319, 8505394, 17411547, 15280640, 12936709, 9755947, 6130514, 3572685, 1815248]
                break;
            case '2012':
                serie.dataM=[-1403403, -5739986, -7758474, -8875967, -8704999, -17393558, -14736999, -12212809, -8876466, -5344287, -2797287, -1148647],
                serie.dataF=[1358871, 5542333, 7474673, 8587202, 8577046, 17562246, 15410113, 13041087, 9830449, 6174929, 3597382, 1827317]
                break;
        }
    } else if(regiao=='Região Centro-Oeste'){
        serie.valueMax = 2000000;
        serie.valueMin = -2000000;
        switch(ano){
            case '2009':
                serie.dataM=[-118756, -487010, -625306, -612400, -630843, -1292776, -1114060, -873572, -571564, -323463, -165342, -66172],
                serie.dataF=[113477, 465461, 599467, 592366, 620564, 1309768, 1175388, 926815, 606493, 343313, 180841, 80250]
                break;
            case '2010':
                serie.dataM=[-107078, -433288, -574584, -637712, -635653, -1313559, -1155310, -916820, -612618, -350382, -177868, -65099],
                serie.dataF=[103908, 418389, 550785, 615646, 629055, 1318784, 1199351, 951991, 645429, 370890, 192675, 81220]
                break;
            case '2011':
                serie.dataM=[-108566, -439226, -582366, -646194, -644078, -1331701, -1170975, -928779, -620299, -354505, -179863, -65811],
                serie.dataF=[105330, 424122, 558237, 623917, 637448, 1336890, 1215476, 964424, 653527, 375352, 194944, 82162]
                break;
            case '2012':
                serie.dataM=[-109977, -444965, -589862, -654429, -652206, -1349260, -1186104, -940341, -627711, -358520, -181801, -66495],
                serie.dataF=[106736, 429619, 565456, 631830, 645622, 1354345, 1231121, 976447, 661314, 379622, 197112, 83057]
                break;
        }
    }else if(regiao=='Região Nordeste'){
        serie.valueMax = 6000000;
        serie.valueMin = -6000000;
        switch(ano){
            case '2009':
                serie.dataM=[-512321, -2074096, -2650027, -2545052, -2588947, -5229409, -3740811, -2836057, -1906176, -1218723, -675232, -333211],
                serie.dataF=[493066, 2007981, 2577982, 2466437, 2501997, 5190755, 3955942, 3146308, 2182815, 1457139, 871136, 429679]
                break;
            case '2010':
                serie.dataM=[-416184, -1736228, -2356583, -2665495, -2581556, -4839187, -3830303, -3002235, -2040184, -1344489, -736794, -359808],
                serie.dataF=[402996, 1676502, 2270108, 2580595, 2555575, 4989791, 4079219, 3270958, 2332074, 1569976, 936372, 508738]
                break;
            case '2011':
                serie.dataM=[-419570, -1750219, -2375152, -2686303, -2601570, -4878878, -3861512, -3025994, -2055672, -1354061, -741716, -362086],
                serie.dataF=[406312, 1690114, 2288279, 2601220, 2575976, 5031033, 4112720, 3297040, 2349843, 1581344, 942921, 512324]
                break;
            case '2012':
                serie.dataM=[-422862, -1763849, -2393269, -2706640, -2621178, -4917236, -3891572, -3048828, -2070624, -1363317, -746591, -364340],
                serie.dataF=[409519, 1703269, 2305643, 2620611, 2595463, 5070995, 4145119, 3322241, 2366937, 1592248, 949172, 515621]
                break;
        }
    }else if(regiao=='Região Norte'){
        serie.valueMax = 2000000;
        serie.valueMin = -2000000;
        switch(ano){
            case '2009':
                serie.dataM=[-158255, -651960, -872330, -832454, -809087, -1520470, -1123046, -798443, -515861, -283330, -58560],
                serie.dataF=[151534, 624933, 838187, 802634, 782318, 1500698, 1120094, 780879, 497045, 279218, 149114, 64787]
                break;
            case '2010':
                serie.dataM=[-153626, -636724, -836427, -893174, -827916, -1515713, -1194671, -853738, -556212, -316561, -62127],
                serie.dataF=[148839, 614359, 804438, 863090, 816573, 1515331, 1190466, 821394, 540294, 308070, 161304, 75381]
                break;
            case '2011':
                serie.dataM=[-155926, -646299, -848854, -906265, -839893, -1538369, -1212379, -865924, -563950, -320800, -62893],
                serie.dataF=[151092, 623562, 816417, 875853, 828533, 1537972, 1207899, 832953, 547592, 312062, 163346, 76339]
                break;
            case '2012':
                serie.dataM=[-158452, -657023, -862636, -920550, -852864, -1563229, -1232017, -880266, -572787, -325426, -63712],
                serie.dataF=[153537, 633943, 829629, 889605, 841321, 1562374, 1226511, 845531, 555292, 316231, 165415, 77271]
                break;
        }
    }else if(regiao=='Região Sudeste'){
        serie.valueMax = 8000000;
        serie.valueMin = -8000000;
        switch(ano){
            case '2009':
                serie.dataM=[-572411, -2474466, -3356538, -3235521, -3280215, -7109726, -6228481, -5271691, -3936435, -2256071, -1203991, -505338],
                serie.dataF=[547314, 2368422, 3223573, 3134137, 3206145, 7169338, 6505433, 5757095, 4428687, 2688104, 1634153, 822352]
                break;
            case '2010':
                serie.dataM=[-521529, -2114682, -2873719, -3361910, -3325399, -7077615, -6253501, -5342466, -4080477, -2385895, -1249826, -489628],
                serie.dataF=[504911, 2043172, 2773795, 3258502, 3269589, 7101013, 6570878, 5777418, 4586480, 2846969, 1689689, 865347]
                break;
            case '2011':
                serie.dataM=[-525601, -2131044, -2895742, -3387536, -3350723, -7133010, -6302148, -5383106, -4110975, -2403236, -1258530, -492908],
                serie.dataF=[508890, 2059276, 2795468, 3283786, 3294753, 7156017, 6621465, 5821071, 4620423, 2867287, 1701337, 871284]
                break;
            case '2012':
                serie.dataM=[-529586, -2147127, -2917385, -3412659, -3375484, -7186566, -6349157, -5422424, -4140501, -2419932, -1266964, -496135],
                serie.dataF=[512693, 2074466, 2815947, 3307673, 3318786, 7209241, 6670443, 5863230, 4653099, 2886976, 1712651, 876858]
                break;
        }
    }else if(regiao=='Região Sul'){
        serie.valueMax = 3000000;
        serie.valueMin = -3000000;
        switch(ano){
            case '2009':
                serie.dataM=[-177282, -777351, -1132901, -1155880, -1202851, -2445269, -2053371, -1885921, -1404655, -830350, -427844, -166512],
                serie.dataF=[169273, 742558, 1084352, 1112650, 1161119, 2399754, 2095822, 2003210, 1520619, 945691, 557488, 266274]
                break;
            case '2010':
                serie.dataM=[-180115, -717533, -982831, -1167122, -1188344, -2345148, -2050537, -1897324, -1447848, -867772, -435377, -156460],
                serie.dataF=[174058, 692038, 946105, 1123515, 1161210, 2333462, 2108857, 2008374, 1575005, 988925, 567154, 271777]
                break;
            case '2011':
                serie.dataM=[-181351, -722372, -989261, -1174627, -1196011, -2361488, -2064617, -1909319, -1456509, -872517, -437608, -157230],
                serie.dataF=[175237, 696684, 952132, 1130543, 1168684, 2349635, 2123080, 2021221, 1584562, 994469, 570137, 273139]
                break;
            case '2012':
                serie.dataM=[-182526, -727022, -995322, -1181689, -1203267, -2377267, -2078149, -1920950, -1464843, -877092, -439746, -157965],
                serie.dataF=[176386, 701036, 957998, 1137483, 1175854, 2365291, 2136919, 2033638, 1593807, 999852, 573032, 274510]
                break;
        }
    }

    chart = new Highcharts.Chart({
        chart: {
            renderTo: 'piramide-etaria-chart',
            defaultSeriesType: 'bar'
        },
        title: {
            text: serie.title + ' - ' + serie.year + ' (' + serie.region + ')'
        },
        xAxis: [{
            categories: categories,
            reversed: false
        }, { // mirror axis on right side
            opposite: true,
            reversed: false,
            categories: categories,
            linkedTo: 0
        }],
        yAxis: {
            title: {
                text: null
            },
            labels: {
                formatter: function(){
                    return (Math.abs(this.value) / 1000000) + 'M';
                }
            },
            min: serie.valueMin,
            max: serie.valueMax
        },

        tooltip: {
            formatter: function(){
                return '<b>'+ this.series.name +', idade: '+ this.point.category +' ano(s)</b><br/>'+
                'População: '+ Highcharts.numberFormat(Math.abs(this.point.y), 0);
            }
        },

        plotOptions: {
            series: {
                stacking: 'normal'
            }
        },

        series: [{
            name: serie.nameM,
            data: serie.dataM
        }, {
            name: serie.nameF,
            data: serie.dataF
        }]
    });
}


function changeSerie(formData) {
    serie.year = formData.selectAno.value;
    serie.region = formData.selectRegiao.value;
    generateChart(serie);
}

$(window).ready(function(){
  generateChart(serie);
})
