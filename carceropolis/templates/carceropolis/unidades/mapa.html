{% extends "base.html" %}
{% load i18n mezzanine_tags staticfiles %}

{% block meta_title %}
    {% if page %}
        {{ page.meta_title }}
    {% else %}
        {% trans "Unidades Prisionais" %}
    {% endif %}
{% endblock %}


{% block extra_css %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.0/dist/leaflet.css"
   integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
   crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.2.0/dist/MarkerCluster.css"/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.2.0/dist/MarkerCluster.Default.css"/>
{% endblock %}

{% block extra_js %}
 <script src="https://unpkg.com/leaflet@1.3.0/dist/leaflet.js"
   integrity="sha512-C7BBF9irt5R7hqbUm2uxtODlUVs+IsNu2UULGuZN7gM+k/mmeG4xvIEac01BtQa4YIkUpp23zZC4wIwuXaPMQA=="
   crossorigin=""></script>
 <script src="https://unpkg.com/leaflet.markercluster@1.2.0/dist/leaflet.markercluster.js"></script>
  <script src="https://unpkg.com/vue@2.5.13/dist/vue.js"></script>
  <script src="{% static "js/map_data.js" %}"></script>
  <script src="{% static "js/map.js" %}"></script>
{% endblock %}

{% block main %}

<style>
 #map {
     height: 600px;
     max-width: 600px;
 }
</style>

<script>
 var states = {{ states }}
</script>

<section class="container">
  <div id="map-vue-app">

    <h1>Unidades Prisionais no Brasil</h1>
    <p>blah blah</p>

    <div>

      <!-- Complete info about unidade -->
      <div v-if="showCompleteInfo" class="completeInfoPannel">
        <h3>Dados Gerais</h3>
        <h3>Perfil Populacional</h3>
      </div>

      <!-- Map side pannel -->
      <div class="map-side-pannel">
        <!-- Filter -->
        <span>Filtro</span>
        <input v-model.trim="filterStr" type="text">

        <!-- Short info about unidade -->
        <div v-if="unidade">
          <h2>[[ unidade.nome_unidade ]]</h2>
          <p v-if="unidade.nome_logradouro">
            [[ formatAddress(unidade) ]]
          </p>
          <p v-if="unidade.email">
            E-mail: <a :href="formatMailto(unidade.email)">[[ unidade.email ]]</a>
          </p>
          <p v-if="unidade.telefone">
            Fone: [[ formatFone(unidade.telefone, unidade.ddd) ]]
          </p>
          <a href="#" @click="showCompleteInfo = true">[ ver dados dessa unidade ]</a>
        </div>
      </div>

      <!-- Map -->
      <div id="map"></div>

    </div>
  </div>
</section>

{% endblock %}
